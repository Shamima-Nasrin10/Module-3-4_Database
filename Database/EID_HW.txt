--Lesson 3: Restricting and sorting data

--1
select last_name, salary 
from hr.employees 
where salary>12000 
order by 2 desc;

--2
select last_name, department_id 
from hr.employees 
where employee_id=176;

--3
select last_name, salary 
from hr.employees 
where salary not between 5000 and 12000;

--4
select last_name, job_id, hire_date 
from hr.employees 
where last_name in('Matos','Taylor')
order by hire_date;

--5
select last_name, department_id 
from hr.employees 
where department_id in(20,50) 
order by 1;

--6
select last_name, salary 
from hr.employees 
where salary between 5000 and 12000 
AND department_id in (20,50);

--7
select last_name, hire_date 
from hr.employees 
where to_char(hire_date,'yyyy') in (2006);

--8
select last_name, job_id 
from hr.employees 
where manager_id is null;

--9
select last_name, salary, commission_pct 
from hr.employees 
where commission_pct is not null 
    order by 2 desc, 3 desc;

--12
select last_name 
from hr.employees 
where last_name like '__a%';

--13
select last_name 
from hr.employees 
where last_name like '%a%' and last_name like '%e%';

--14
select last_name, job_id, salary 
from hr.employees 
where job_id in('SA_REP','ST_CLERK') 
AND salary not in(2500,3500,7000);

--15
select last_name "Employee", salary "Monthly Salary", commission_pct 
from hr.employees 
where commission_pct =0.2;





--Lesson 4: Using single row functions to customize output

--1
select sysdate "Date"
from dual;

--2
select last_name, employee_id, salary, round(salary+(salary*0.155)) "New Salary"
from hr.employees;

--3
select last_name, employee_id, salary, round(salary+(salary*0.155)) "New Salary", round(salary+(salary*0.155))-salary "Increase"
from hr.employees;

--5a
select last_name, length(last_name) "Length"
from hr.employees
where last_name like 'A%'
    and last_name like 'J%'
    and last_name like 'M%'
order by last_name;

--6
select last_name, round(months_between(sysdate, hire_date)) "MONTHS_WORKED"
from hr.employees;

--7
select last_name, lpad(salary,15,'$') "SALARY"
from hr.employees;

--8
select last_name, rpad(' ',salary/1000,'*') "Employees and their salaries"
from hr.employees
order by salary desc;

--9
select last_name, trunc((sysdate-hire_date)/7) "Tenure"
from hr.employees
    where department_id=90
    order by 2  desc;
	
	
	
	
--Lesson 5: Using Conversion Functions and Conditional

--1
select  last_name || ' earns ' 
        || to_char(salary, 'fm$99,999.00') 
        || ' monthly but wants ' 
        || to_char(salary * 3, 'fm$99,999.00') 
        || '.' "Dream Salaries" 
from    employees; 

--2
select last_name, hire_date, 
       to_char(next_day(add_months(hire_date, 6),'Monday'), 
       'fmDay, "the" Ddspth "of" Month, YYYY') "Review"
from    employees; 

--3
select last_name, 
       nvl(to_char(commission_pct), 'No Commission') "COMM"
from   employees; 

--4
select job_id, case job_id 
               when 'ST_CLERK' then 'E' 
               when 'SA_REP'   then 'D' 
               when 'IT_PROG'  then 'C' 
               when 'ST_MAN'   then 'B' 
               when 'AD_PRES'  then 'A' 
               else '0'  end  "Grade" 
from employees;  

--5
select job_id, case               
               when job_id = 'ST_CLERK' then 'E' 
               when job_id = 'SA_REP'   then 'D' 
               when job_id = 'IT_PROG'  then 'C' 
               when job_id = 'ST_MAN'   then 'B' 
               when job_id = 'AD_PRES'  then 'A' 
               else '0'  end  "Grade"
from employees; 

--6
select job_id, decode (job_id, 
                   'ST_CLERK',  'E', 
                   'SA_REP',    'D', 
                   'IT_PROG',   'C', 
                   'ST_MAN',    'B', 
                   'AD_PRES',   'A', 
                   '0') "Grade"  
from employees;